import{E as j}from"https://app.framerstatic.com/chunk-4BR6WBUV.mjs";import{Gt as N,I as O,hb as R,u as y}from"https://app.framerstatic.com/chunk-JMNEQD26.mjs";import{w as H}from"https://app.framerstatic.com/chunk-5GP6FPZ7.mjs";import{a as D,e as S,f as w,i as F}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{v as g}from"https://app.framerstatic.com/chunk-CQ6F5PRQ.mjs";import{a as m}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{a as A}from"https://app.framerstatic.com/chunk-LQILWJHN.mjs";import{j as v}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var E=g("initializeAssetResolver"),h,C;function J(t){if(h)throw new Error("initializeAssetResolver() should only be called once");return E.debug("initializeAssetResolver",{assetMap:t}),h=H(A().userContent,t),C=t,h}function U(){if(h===void 0)throw new Error("getAssetResolver() should not be called before initializeAssetResolver()");return h}function K(){if(C===void 0)throw new Error("getCurrentAssetMapHash() should not be called before initializeAssetResolver()");let t=U(),e=C.hash;return{assetResolver:t,assetMapHash:e}}var L=g("layout-measuring/projection");function X(t){return{x:t.x/t.w,y:t.y/t.w}}function Y(t,e){let n=0,o=0;for(let c=1;c<e.length;c++){let r=e[c];r.x<e[n].x&&(n=c),r.y<e[o].y&&(o=c)}let s=t[n],i=t[o];return m(s!==void 0&&i!==void 0,"minX, minY points must be defined",n,o,t),{minX:new DOMPoint(s.x,s.y),minY:new DOMPoint(i.x,i.y)}}function ne(t,e,n,o){let s=t.multiply(e),i=o.map(f=>X(s.transformPoint(f))),{x:c,y:r}=I(t,e,n,Y(o,i)),a=t.translate(c,r).multiplySelf(e),d=o.map(f=>X(a.transformPoint(f)));if(!O.anyPointsOutsideRect(n,d))return{x:c,y:r,matrix:a};let l=I(t,e,n,Y(o,d));return{x:l.x,y:l.y,matrix:t.translate(l.x,l.y).multiplySelf(e)}}function oe(t,e,n){let o=new DOMPoint(e.x,e.y);return I(t,j.identity(),n,{minX:o,minY:o})}function I(t,e,n,{minX:o,minY:s}){let i=t,c=e,r=n,{a,b:d,c:l}=B(i,c,o,r.x,1),{a:f,b:u,c:p}=B(i,c,s,r.y,2),b=(d*p-u*l)/(f*d-a*u),x=(a*p-f*l)/(a*u-f*d);return f*d===a*u?(L.error("Unsolvable coordinates:",{parentMatrix:t,matrix:e,target2dPoint:n,minxp:o,minyp:s}),{x:0,y:0}):{x:b,y:x}}function B(t,e,n,o,s){let i=t["m1"+s],c=e.m14*i*n.x+e.m24*i*n.y+e.m44*i,r=t["m2"+s],a=e.m14*r*n.x+e.m24*r*n.y+e.m44*r,d=t["m3"+s],l=t["m4"+s],f=(e.m11*i+e.m12*r+e.m13*d+e.m14*l)*n.x+(e.m21*i+e.m22*r+e.m23*d+e.m24*l)*n.y+e.m41*i+e.m42*r+e.m43*d+e.m44*l,u=e.m14*t.m14*n.x+e.m24*t.m14*n.y+e.m44*t.m14,p=e.m14*t.m24*n.x+e.m24*t.m24*n.y+e.m44*t.m24,b=(e.m11*t.m14+e.m12*t.m24+e.m13*t.m34+e.m14*t.m44)*n.x+(e.m21*t.m14+e.m22*t.m24+e.m23*t.m34+e.m24*t.m44)*n.y+e.m41*t.m14+e.m42*t.m24+e.m43*t.m34+e.m44*t.m44,x=c-o*u,V=a-o*p,z=o*b-f;return{a:x,b:V,c:z}}function W(){y.frame.addScope("is-hidden",1500),y.component.addScope("is-hidden",1500)}function k(){y.frame.removeScope("is-hidden"),y.component.removeScope("is-hidden")}function P(t,e,n){if(F(t.hidden))return!1;if(D(t.hidden))return t.hidden;try{W();let o=t.hidden(e,n);return k(),o}catch{return k(),!1}}var q=class{constructor(e){this.engine=e}async requestHiddenStateForComponentControls(e){let n=e.args,o=this.engine.tree,s={};return Object.entries(n).forEach(([i,{controlNames:c}])=>{let r=o.getNode(i);if(!r)return;m(N(r),"Node is not a CanvasNode with control props (node.__class: ",r.__class,")");let a=r.getControlPropSourceIdentifier();m(a,"Cannot find component identifier for node");let d=R.reactComponentForIdentifier(a);if(!d||!d.properties)return;let l=c??Object.keys(d.properties),f=r.getResolvedControlPropValues(R);s[i]=_(l,d,f)}),{hiddenControlsByNodeId:s}}async requestHiddenStateForActionControls(e){let{actionIdentifier:n,controlNames:o,actionProps:s}=e;m(n,"Fail to request hidden state for action controls: missing actionIdentifier");let i=R.componentForIdentifier(n);return{hiddenState:o.reduce((r,a)=>{let d=i?i.properties[a]:void 0;return d?(r[a]=P(d,s,s),r):(r[a]=!1,r)},{})}}async requestHiddenStateForModuleControls(e){let n=R.reactComponentForIdentifier(e.moduleIdentifier);return n?.properties?{hiddenState:_(e.controlNames??Object.keys(n.properties),n,e.moduleProps)}:{hiddenState:{}}}};function M(t,e,n,o,s,i){let c=t+e;if(n){if(n.hidden&&(i[c]=P(n,o,s)),n.type==="object"){let r=o[e];if(!S(r))return;for(let a in n.controls){let d=n.controls[a];M(c+".",a,d,r,s,i)}}if(n.type==="array"&&n.control.type==="object"){let r=o[e];if(!w(r))return;let a=r.length;for(let d=0;d<a;d++){let l=r[d];if(S(l))for(let f in l){let u=n.control.controls[f];M(c+`[${d}].`,f,u,l,s,i)}}}}}function _(t,e,n){let o={};for(let s of t){let i=e.properties[s];M("",s,i,n,n,o)}return o}var T=class{constructor(e){this.environment=e;v(this,"visibleRenderIds",new Set);v(this,"addedRenderIds",new Set);v(this,"removedRenderIds",new Set)}setVisible(e,n){m(this.environment==="sandbox","Setting data is only allowed in the sandbox.");let o=this.getVisible(e);n!==o&&(n?(this.visibleRenderIds.add(e),this.addedRenderIds.add(e),this.removedRenderIds.delete(e)):(this.visibleRenderIds.delete(e),this.removedRenderIds.add(e),this.addedRenderIds.delete(e)))}import(e){m(this.environment==="editor","Importing data is only allowed in the editor.");let n=new Set;for(let o of e.addedRenderIds)this.visibleRenderIds.add(o),n.add(o);for(let o of e.removedRenderIds)this.visibleRenderIds.delete(o),n.add(o);return n}getVisible(e){return this.visibleRenderIds.has(e)}export(){m(this.environment==="sandbox","No need to collect and send updates from within the editor.");let e=Array.from(this.addedRenderIds),n=Array.from(this.removedRenderIds);return this.addedRenderIds.clear(),this.removedRenderIds.clear(),{addedRenderIds:e,removedRenderIds:n}}};export{ne as a,oe as b,q as c,T as d,J as e,U as f,K as g};
//# sourceMappingURL=https://app.framerstatic.com/chunk-CRNX7RGT.mjs.map
